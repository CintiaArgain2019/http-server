/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds/
 */

apply plugin: 'java' 

repositories {
    mavenCentral()
}

dependencies {
    testCompile group: 'info.cukes', name: 'cucumber-picocontainer', version: '1.2.5'
    testCompile 'info.cukes:cucumber-java:1.2.4'
    testCompile 'info.cukes:cucumber-junit:1.2.4'
    testCompile 'junit:junit:4.12'
}

def defaultPort = 8888
def testDirectoryPath = System.getProperty("user.dir") + '/src/test/resources/testFiles'

task startServer(type: JavaExec) {
    classpath sourceSets.main.runtimeClasspath
    main = "Main"
    args "-port", defaultPort, "-dir", testDirectoryPath

}

task createLogsDirectory() {
    def logDir = new File(System.getProperty("user.dir") + '/logs')
    logDir.mkdir()
}

build.dependsOn(createLogsDirectory)

test {
    systemProperty 'PORT', defaultPort
    systemProperty 'TEST_DIRECTORY_PATH', testDirectoryPath

    testLogging {
        exceptionFormat = 'full'
        events = ["passed", "failed", "skipped", "standardOut", "standardError"]
    }
}

jar {
    manifest {
        attributes 'Main-Class': 'Main'
    }
}
